<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiCAR EMT License Tracker - Electronic Money Token Issuers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(90deg, #58c1ba, #004aad);
            min-height: 100vh;
        }
        
        .main-bg {
            background: linear-gradient(90deg, #58c1ba, #004aad);
        }
        
        .header-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
            backdrop-filter: blur(10px);
            background: linear-gradient(90deg, rgba(88, 193, 186, 0.95), rgba(0, 74, 173, 0.95));
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .progress-bar {
            transition: width 0.8s ease-in-out;
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .kpi-card {
            background: linear-gradient(135deg, var(--start-color), var(--end-color));
        }
        
        /* Complementary colors to the teal-blue gradient */
        .kpi-teal { --start-color: #14b8a6; --end-color: #0f766e; }
        .kpi-blue { --start-color: #0ea5e9; --end-color: #0369a1; }
        .kpi-orange { --start-color: #f97316; --end-color: #ea580c; }
        .kpi-coral { --start-color: #f43f5e; --end-color: #e11d48; }
        .kpi-purple { --start-color: #8b5cf6; --end-color: #7c3aed; }
        .kpi-red { --start-color: #dc2626; --end-color: #b91c1c; }
        
        .search-input {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        .content-bg {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
        }
        
        .logo-container {
            max-height: 80px;
            width: auto;
            margin-right: 20px;
        }
        
        .tab-button {
            transition: all 0.3s ease;
        }
        
        .tab-active {
            background: white;
            color: #1e40af;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .tab-inactive {
            background: rgba(59, 130, 246, 0.3);
            color: white;
        }
        
        .tab-inactive:hover {
            background: rgba(59, 130, 246, 0.5);
        }
    </style>
    <style>
        /* hide the ‚Äúxx.x% of total‚Äù under each card */
        #eurPercentage,
        #usdPercentage,
        #gbpPercentage,
        #czkPercentage {
          display: none;
        }
      </style>

      <style>
  /* hide the entire ‚ÄúCurrency Distribution Analysis‚Äù card */
  .card-hover:has(.fa-coins) {
    display: none !important;
  }
</style>
</head>
<body class="main-bg">
    <!-- Sticky Header -->
    <div class="header-sticky shadow-2xl">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex items-center justify-between flex-wrap">
                <div class="flex items-start space-x-6 mb-4 md:mb-0">
                    <img src="https://cdn.abacus.ai/images/5bf38e3c-f4e1-4450-8d41-277ada1b7069.png" 
                         alt="DEA Logo" class="logo-container">
                    <div>
                        <h1 class="text-4xl font-bold text-white mb-1">MiCAR EMT License Tracker</h1>
                        <p class="text-blue-100 text-lg">Electronic Money Token Issuers Analytics</p>
                        <p class="text-blue-200 text-sm mt-1">Source: ESMA EMT Register, 30 June 2025</p>
                    </div>
                </div>
                <div class="flex space-x-3">
                    <button id="overviewBtn" class="tab-button tab-active px-5 py-3 rounded-xl font-semibold">
                        <i class="fas fa-chart-pie mr-2"></i>Overview
                    </button>
                    <button id="detailsBtn" class="tab-button tab-inactive px-5 py-3 rounded-xl font-semibold">
                        <i class="fas fa-table mr-2"></i>Details
                    </button>
                    <button id="nonCompliantBtn" class="tab-button tab-inactive px-5 py-3 rounded-xl font-semibold">
                        <i class="fas fa-exclamation-triangle mr-2"></i>Non-Compliant
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8 fade-in">
            <div class="kpi-card kpi-teal p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">Total Issuers</p>
                        <p class="text-3xl font-bold mt-2" id="totalIssuers">14</p>
                        <p class="text-sm opacity-80 mt-1">Active EMT Providers</p>
                    </div>
                    <div class="text-4xl opacity-80">üè¢</div>
                </div>
            </div>

            <div class="kpi-card kpi-blue p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">Total Tokens</p>
                        <p class="text-3xl font-bold mt-2" id="totalTokens">19</p>
                        <p class="text-sm opacity-80 mt-1">Authorized EMTs</p>
                    </div>
                    <div class="text-4xl opacity-80">ü™ô</div>
                </div>
            </div>

            <div class="kpi-card kpi-orange p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">EUR Tokens</p>
                        <p class="text-3xl font-bold mt-2" id="euroTokens">10</p>
                        <p class="text-sm opacity-80 mt-1">Euro-backed</p>
                    </div>
                    <div class="text-4xl opacity-80">üí∂</div>
                </div>
            </div>

            <div class="kpi-card kpi-coral p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">USD Tokens</p>
                        <p class="text-3xl font-bold mt-2" id="usdTokens">7</p>
                        <p class="text-sm opacity-80 mt-1">Dollar-backed</p>
                    </div>
                    <div class="text-4xl opacity-80">üíµ</div>
                </div>
            </div>

            <div class="kpi-card kpi-purple p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">GBP Tokens</p>
                        <p class="text-3xl font-bold mt-2" id="gbpTokens">1</p>
                        <p class="text-sm opacity-80 mt-1">Pound-backed</p>
                    </div>
                    <div class="text-4xl opacity-80">üí∑</div>
                </div>
            </div>

            <div class="kpi-card kpi-purple p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm opacity-90 font-medium">CZK Tokens</p>
                    <p class="text-3xl font-bold mt-2" id="czkTokens">1</p>
                    <p class="text-sm opacity-80 mt-1">Czech Koruna backed</p>
                  </div>
                  <div class="text-4xl opacity-80">üá®üáø</div>
                </div>
              </div>
              
            <div class="kpi-card kpi-coral p-6 rounded-2xl shadow-lg text-white card-hover">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm opacity-90 font-medium">Non-Compliant</p>
                        <p class="text-3xl font-bold mt-2" id="nonCompliantCount">33</p>
                        <p class="text-sm opacity-80 mt-1">Flagged Entities</p>
                    </div>
                    <div class="text-4xl opacity-80">‚ö†Ô∏è</div>
                </div>
            </div>
        </div>

        <!-- Overview Section -->
        <div id="overviewSection" class="fade-in">
            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white bg-opacity-95 backdrop-filter backdrop-blur-lg rounded-2xl shadow-lg p-6 card-hover">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-globe-europe text-teal-600 mr-2"></i>Geographic Distribution
                    </h3>
                    <div class="space-y-4" id="countryChart">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="bg-white bg-opacity-95 backdrop-filter backdrop-blur-lg rounded-2xl shadow-lg p-6 card-hover">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-university text-blue-600 mr-2"></i>Regulatory Authorities
                    </h3>
                    <div class="space-y-4" id="authorityChart">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Currency Distribution -->
            <div class="bg-white bg-opacity-95 backdrop-filter backdrop-blur-lg rounded-2xl shadow-lg p-6 card-hover">
                <h3 class="text-xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-coins text-orange-600 mr-2"></i>Currency Distribution Analysis
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center p-6 bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl">
                        <div class="text-4xl mb-3">üí∂</div>
                        <div class="text-2xl font-bold text-teal-600" id="eurPercent">10</div>
                        <div class="text-gray-600">EUR Tokens</div>
                        <div class="text-sm text-gray-500 mt-2" id="eurPercentage">52.6% of total</div>
                    </div>
                    <div class="text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl">
                        <div class="text-4xl mb-3">üíµ</div>
                        <div class="text-2xl font-bold text-blue-600" id="usdPercent">7</div>
                        <div class="text-gray-600">USD Tokens</div>
                        <div class="text-sm text-gray-500 mt-2" id="usdPercentage">36.8% of total</div>
                    </div>
                    <div class="text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl">
                        <div class="text-4xl mb-3">üí∑</div>
                        <div class="text-2xl font-bold text-green-600" id="gbpPercent">1</div>
                        <div class="text-gray-600">GBP Tokens</div>
                        <div class="text-sm text-gray-500 mt-2" id="gbpPercentage">5.3% of total</div>
                    </div>
                    <div class="text-center p-6 bg-gradient-to-br from-purple-50 to-violet-100 rounded-xl">
                        <div class="text-4xl mb-3">üá®üáø</div>
                        <div class="text-2xl font-bold text-purple-600" id="czkPercent">1</div>
                        <div class="text-gray-600">CZK Tokens</div>
                        <div class="text-sm text-gray-500 mt-2" id="czkPercentage">5.3% of total</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Details Section -->
        <div id="detailsSection" class="hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-filter backdrop-blur-lg rounded-2xl shadow-lg p-6 card-hover">
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 md:mb-0">
                        <i class="fas fa-list-alt text-teal-600 mr-2"></i>Detailed Issuer Information
                    </h3>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="Search issuers, countries, tokens..." 
                                   class="search-input pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-teal-500 focus:border-transparent w-64">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                        <button id="clearSearch" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                            <i class="fas fa-times mr-1"></i>Clear
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gradient-to-r from-teal-50 to-blue-50">
                                <th class="text-left p-4 font-semibold text-gray-700">Issuer</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Country</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Authority</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Tokens</th>
                                <th class="text-center p-4 font-semibold text-gray-700">Count</th>
                                <th class="text-center p-4 font-semibold text-gray-700">Currencies</th>
                            </tr>
                        </thead>
                        <tbody id="detailsTable">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div id="noResults" class="hidden text-center py-8 text-gray-500">
                    <i class="fas fa-search text-4xl mb-4"></i>
                    <p class="text-lg">No results found for your search.</p>
                </div>
            </div>
        </div>

        <!-- Non-Compliant Section -->
        <div id="nonCompliantSection" class="hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-filter backdrop-blur-lg rounded-2xl shadow-lg p-6 card-hover">
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 md:mb-0">
                        <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>Non-Compliant Entities
                    </h3>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <input type="text" id="nonCompliantSearchInput" placeholder="Search entities, authorities, websites..." 
                                   class="search-input pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-transparent w-64">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                        <button id="clearNonCompliantSearch" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                            <i class="fas fa-times mr-1"></i>Clear
                        </button>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gradient-to-r from-red-50 to-orange-50">
                                <th class="text-left p-4 font-semibold text-gray-700">Entity Name</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Country</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Regulatory Authority</th>
                                <th class="text-left p-4 font-semibold text-gray-700">Websites</th>
                                <th class="text-center p-4 font-semibold text-gray-700">Status</th>
                            </tr>
                        </thead>
                        <tbody id="nonCompliantTable">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div id="noNonCompliantResults" class="hidden text-center py-8 text-gray-500">
                    <i class="fas fa-search text-4xl mb-4"></i>
                    <p class="text-lg">No results found for your search.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-gray-300">MiCAR EMT License Tracker - Electronic Money Token Regulatory Overview</p>
            <p class="text-gray-400 text-sm mt-2" id="currentDate"></p>
        </div>
    </div>

    <script>
        // Data
        const data = [
            { id: 1, issuer: "Circle Internet Financial EU SAS", state: "France", authority: "ACPR", tokens: "EURC, USDC", count: 2, euro: 1, usd: 1, czk: 0, gbp: 0 },
            { id: 2, issuer: "Soci√©t√© G√©n√©rale ‚Äì Forge", state: "France", authority: "ACPR", tokens: "EURCV", count: 1, euro: 1, usd: 0, czk: 0, gbp: 0 },
            { id: 4, issuer: "Schuman Financial SAS", state: "France", authority: "ACPR", tokens: "EUR√òP", count: 1, euro: 1, usd: 0, czk: 0, gbp: 0 },
            { id: 5, issuer: "Membrane Finance Oy", state: "Finland", authority: "FIN-FSA", tokens: "eUSD, eUSD", count: 2, euro: 1, usd: 1, czk: 0, gbp: 0 },
            { id: 6, issuer: "Eurodollar ApS", state: "Denmark", authority: "Finanstilsynet", tokens: "USDE", count: 1, euro: 0, usd: 1, czk: 0, gbp: 0 },
            { id: 7, issuer: "Banking Circle S.A.", state: "Luxembourg", authority: "CSSF", tokens: "EURI", count: 1, euro: 1, usd: 0, czk: 0, gbp: 0 },
            { id: 8, issuer: "Quantoz Payments B.V.", state: "Netherlands", authority: "Dutch National Bank", tokens: "EURQ / USDQ/ EURD", count: 2, euro: 1, usd: 1, czk: 0, gbp: 0 },
            { id: 9, issuer: "StablR Ltd", state: "Malta", authority: "MFSA", tokens: "USDR, EURR", count: 2, euro: 1, usd: 1, czk: 0, gbp: 0 },
            { id: 10, issuer: "Stablemint Ltd", state: "Malta", authority: "MFSA", tokens: "EURsm, USDsm", count: 2, euro: 1, usd: 1, czk: 0, gbp: 0 },
            { id: 11, issuer: "Ambr Payments UAB", state: "Lithuania", authority: "Bank of Lithuania", tokens: "", count: 0, euro: 0, usd: 0, czk: 0, gbp: 0 },
            { id: 12, issuer: "UAB Blue EMI LT", state: "Lithuania", authority: "Bank of Lithuania", tokens: "BLUEUR", count: 1, euro: 1, usd: 0, czk: 0, gbp: 0 },
            { id: 13, issuer: "Stable Europe", state: "Czech Republic", authority: "Czech National Bank", tokens: "CZKI", count: 1, euro: 0, usd: 0, czk: 1, gbp: 0 },
            { id: 14, issuer: "Fiat Republic Netherlands B.V.", state: "Netherlands", authority: "Dutch National Bank", tokens: "ENEUR, ENGBP", count: 2, euro: 1, usd: 0, czk: 0, gbp: 1 }
        ];

        // Non-compliant entities data
        const nonCompliantData = [
            { id: 1, entity: "Dobibo", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://dobibo.com", "https://dobibo1.com", "https://dobibo2.com"] },
            { id: 2, entity: "Fameexn", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://fameexn.top", "https://fameexn.com"] },
            { id: 3, entity: "Spazio Finanziario", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["www.spaziofinanziario.com"] },
            { id: 4, entity: "HTXcoin-az", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://m.htxcoin-az.com"] },
            { id: 5, entity: "Stock Credit Wallet", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://stockcreditwallet.com"] },
            { id: 6, entity: "Paycraftv.top - Paycraftn.top", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://paycraftv.top", "https://paycraftn.top"] },
            { id: 7, entity: "CoinBank Exchange", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://coinbankexchange.icu"] },
            { id: 8, entity: "AKQ", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://akqa715.it", "https://AKQ1181.it"] },
            { id: 9, entity: "Fameexn", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://fameexe.top", "https://fameexj.top"] },
            { id: 10, entity: "ArgonInternational", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://argonintgroup.com", "https://cfd.argonintgroup.com"] },
            { id: 11, entity: "Deroka UAB", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://dtcoin.tech", "https://dtwallet.io", "https://forcedmarketcap.tech"] },
            { id: 12, entity: "DTSocialize Holding PLC", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://dtsmoney.com", "https://portal.dtsmoney.com"] },
            { id: 13, entity: "Caa871", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://caa871.it"] },
            { id: 14, entity: "Sdf837", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://sdf837.it"] },
            { id: 15, entity: "SYBZ", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://sybzgroup.co"] },
            { id: 16, entity: "Egplus.vip", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://egplus.vip"] },
            { id: 17, entity: "Egalite.bond", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://egalite.bond"] },
            { id: 18, entity: "Arbismart UAB", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://arbismart.com", "https://dashboard.arbismart.com"] },
            { id: 19, entity: "Blockbyteq", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://blockbyteq.top"] },
            { id: 20, entity: "Bvoxed", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://bvoxed.com"] },
            { id: 21, entity: "BeratCoin", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://btc6688.com"] },
            { id: 22, entity: "Interersos-Interesosf", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://interersosf.org", "https://interersos.org"] },
            { id: 23, entity: "Cfw896", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://cfw896.it"] },
            { id: 24, entity: "Lumex", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://stratoslumex.com", "https://stratoslumex.net"] },
            { id: 25, entity: "Tmxa", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://60yg.com"] },
            { id: 26, entity: "Uyr968|Fwq367", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://uyr968.it", "https://fwq367.it"] },
            { id: 27, entity: "Syk755", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["www.syk755.it"] },
            { id: 28, entity: "Pxm266", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://pxm266.it"] },
            { id: 29, entity: "Hct685", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://hct685.it"] },
            { id: 30, entity: "Sdh878", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://sdh878.it"] },
            { id: 31, entity: "Skillnexp", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://skillnexp.top"] },
            { id: 32, entity: "Ymg686", country: "Italy", authority: "Commissione Nazionale per le Societa e la Borsa (CONSOB)", websites: ["https://ymg686.it"] },
            { id: 33, entity: "LWEX", country: "Slovakia", authority: "National Bank of Slovakia (NBS)", websites: ["https://lwex.com/"] }
        ];

        let filteredData = [...data];
        let filteredNonCompliantData = [...nonCompliantData];

        // Calculate aggregated data
        const totalIssuers = data.length;
        const totalTokens = data.reduce((sum, item) => sum + item.count, 0);
        const euroTokens = data.reduce((sum, item) => sum + item.euro, 0);
        const usdTokens = data.reduce((sum, item) => sum + item.usd, 0);
        const czkTokens = data.reduce((sum, item) => sum + item.czk, 0);
        const gbpTokens = data.reduce((sum, item) => sum + item.gbp, 0);
        const nonCompliantCount = nonCompliantData.length;

        // Country and authority distributions (sorted by count descending)
        const countryData = Object.entries(data.reduce((acc, item) => {
            acc[item.state] = (acc[item.state] || 0) + 1;
            return acc;
        }, {})).sort((a, b) => b[1] - a[1]);

        const authorityData = Object.entries(data.reduce((acc, item) => {
            acc[item.authority] = (acc[item.authority] || 0) + 1;
            return acc;
        }, {})).sort((a, b) => b[1] - a[1]);

        // Initialize dashboard
        function initDashboard() {
            // Set current date
            document.getElementById('currentDate').textContent = `Data as of ${new Date().toLocaleDateString()}`;

            // Update KPIs
            document.getElementById('totalIssuers').textContent = totalIssuers;
            document.getElementById('totalTokens').textContent = totalTokens;
            document.getElementById('euroTokens').textContent = euroTokens;
            document.getElementById('usdTokens').textContent = usdTokens;
            document.getElementById('gbpTokens').textContent = gbpTokens;
            document.getElementById('czkTokens').textContent = czkTokens;
            document.getElementById('nonCompliantCount').textContent = nonCompliantCount;

            // Update percentages
            document.getElementById('eurPercent').textContent = euroTokens;
            document.getElementById('usdPercent').textContent = usdTokens;
            document.getElementById('gbpPercent').textContent = gbpTokens;
            document.getElementById('czkPercent').textContent = czkTokens;
            document.getElementById('eurPercentage').textContent = `${((euroTokens/totalTokens)*100).toFixed(1)}% of total`;
            document.getElementById('usdPercentage').textContent = `${((usdTokens/totalTokens)*100).toFixed(1)}% of total`;
            document.getElementById('gbpPercentage').textContent = `${((gbpTokens/totalTokens)*100).toFixed(1)}% of total`;
            document.getElementById('czkPercentage').textContent = `${((czkTokens/totalTokens)*100).toFixed(1)}% of total`;

            // Populate charts and tables
            populateCountryChart();
            populateAuthorityChart();
            populateDetailsTable();
            populateNonCompliantTable();
        }

        function populateCountryChart() {
            const container = document.getElementById('countryChart');
            const maxCount = countryData[0][1]; // First item has highest count due to sorting
            
            // Country flag mapping
            const countryFlags = {
                'France': 'üá´üá∑',
                'Finland': 'üá´üáÆ',
                'Denmark': 'üá©üá∞',
                'Luxembourg': 'üá±üá∫',
                'Netherlands': 'üá≥üá±',
                'Malta': 'üá≤üáπ',
                'Lithuania': 'üá±üáπ',
                'Czech Republic': 'üá®üáø'
            };
            
            container.innerHTML = countryData.map(([country, count]) => `
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <span class="text-xl">${countryFlags[country] || 'üè≥Ô∏è'}</span>
                        <span class="text-gray-700 font-medium">${country}</span>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="w-32 bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-teal-500 to-blue-600 h-3 rounded-full progress-bar" 
                                 style="width: ${(count / maxCount) * 100}%"></div>
                        </div>
                        <span class="text-teal-600 font-bold text-lg">${count}</span>
                    </div>
                </div>
            `).join('');
        }

        function populateAuthorityChart() {
            const container = document.getElementById('authorityChart');
            const maxCount = authorityData[0][1]; // First item has highest count due to sorting
            
            container.innerHTML = authorityData.map(([authority, count]) => `
                <div class="flex items-center justify-between">
                    <span class="text-gray-700 font-medium text-sm">${authority}</span>
                    <div class="flex items-center space-x-3">
                        <div class="w-32 bg-gray-200 rounded-full h-3">
                            <div class="bg-gradient-to-r from-teal-500 to-blue-600 h-3 rounded-full progress-bar" 
                                 style="width: ${(count / maxCount) * 100}%"></div>
                        </div>
                        <span class="text-teal-600 font-bold text-lg">${count}</span>
                    </div>
                </div>
            `).join('');
        }

        function populateDetailsTable(dataToShow = filteredData) {
            const tbody = document.getElementById('detailsTable');
            const noResults = document.getElementById('noResults');
            
            if (dataToShow.length === 0) {
                tbody.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            tbody.innerHTML = dataToShow.map((item, index) => `
                <tr class="border-b hover:bg-gradient-to-r hover:from-teal-50 hover:to-blue-50 transition-all duration-200 ${index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}">
                    <td class="p-4">
                        <div class="font-semibold text-gray-800">${item.issuer}</div>
                    </td>
                    <td class="p-4">
                        <span class="px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium">
                            ${item.state}
                        </span>
                    </td>
                    <td class="p-4 text-gray-600 text-sm">${item.authority}</td>
                    <td class="p-4">
                        <div class="text-sm text-gray-800 font-mono">${item.tokens || 'N/A'}</div>
                    </td>
                    <td class="p-4 text-center">
                        <span class="px-3 py-1 rounded-full text-sm font-bold ${
                            item.count > 1 ? 'bg-green-100 text-green-800' : 
                            item.count === 1 ? 'bg-yellow-100 text-yellow-800' : 
                            'bg-gray-100 text-gray-600'
                        }">
                            ${item.count}
                        </span>
                    </td>
                    <td class="p-4 text-center">
                        <div class="flex justify-center space-x-1">
                            ${item.euro ? '<span class="px-2 py-1 bg-orange-100 text-orange-700 rounded text-xs font-semibold">EUR</span>' : ''}
                            ${item.usd ? '<span class="px-2 py-1 bg-coral-100 text-pink-700 rounded text-xs font-semibold">USD</span>' : ''}
                            ${item.gbp ? '<span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-semibold">GBP</span>' : ''}
                            ${item.czk ? '<span class="px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs font-semibold">CZK</span>' : ''}
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function populateNonCompliantTable(dataToShow = filteredNonCompliantData) {
            const tbody = document.getElementById('nonCompliantTable');
            const noResults = document.getElementById('noNonCompliantResults');
            
            if (dataToShow.length === 0) {
                tbody.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }
            
            noResults.classList.add('hidden');
            tbody.innerHTML = dataToShow.map((item, index) => `
                <tr class="border-b hover:bg-gradient-to-r hover:from-red-50 hover:to-orange-50 transition-all duration-200 ${index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}">
                    <td class="p-4">
                        <div class="font-semibold text-gray-800">${item.entity}</div>
                    </td>
                    <td class="p-4">
                        <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-medium">
                            ${item.country} ${item.country === 'Italy' ? 'üáÆüáπ' : item.country === 'Slovakia' ? 'üá∏üá∞' : ''}
                        </span>
                    </td>
                    <td class="p-4 text-gray-600 text-sm">${item.authority}</td>
                    <td class="p-4">
                        <div class="space-y-1">
                            ${item.websites.map(website => `
                                <div class="text-xs text-blue-600 font-mono bg-blue-50 px-2 py-1 rounded">
                                    ${website}
                                </div>
                            `).join('')}
                        </div>
                    </td>
                    <td class="p-4 text-center">
                        <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm font-bold">
                            <i class="fas fa-exclamation-triangle mr-1"></i>Flagged
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // Search functionality
        function filterData(searchTerm) {
            if (!searchTerm.trim()) {
                filteredData = [...data];
            } else {
                const term = searchTerm.toLowerCase();
                filteredData = data.filter(item => 
                    item.issuer.toLowerCase().includes(term) ||
                    item.state.toLowerCase().includes(term) ||
                    item.authority.toLowerCase().includes(term) ||
                    item.tokens.toLowerCase().includes(term)
                );
            }
            populateDetailsTable(filteredData);
        }

        function filterNonCompliantData(searchTerm) {
            if (!searchTerm.trim()) {
                filteredNonCompliantData = [...nonCompliantData];
            } else {
                const term = searchTerm.toLowerCase();
                filteredNonCompliantData = nonCompliantData.filter(item => 
                    item.entity.toLowerCase().includes(term) ||
                    item.country.toLowerCase().includes(term) ||
                    item.authority.toLowerCase().includes(term) ||
                    item.websites.some(website => website.toLowerCase().includes(term))
                );
            }
            populateNonCompliantTable(filteredNonCompliantData);
        }

        // Tab switching functionality
        function switchTab(tab) {
            const overviewBtn = document.getElementById('overviewBtn');
            const detailsBtn = document.getElementById('detailsBtn');
            const nonCompliantBtn = document.getElementById('nonCompliantBtn');
            const overviewSection = document.getElementById('overviewSection');
            const detailsSection = document.getElementById('detailsSection');
            const nonCompliantSection = document.getElementById('nonCompliantSection');

            // Reset all buttons
            [overviewBtn, detailsBtn, nonCompliantBtn].forEach(btn => {
                btn.className = 'tab-button tab-inactive px-5 py-3 rounded-xl font-semibold';
            });

            // Hide all sections
            [overviewSection, detailsSection, nonCompliantSection].forEach(section => {
                section.classList.add('hidden');
            });

            // Show selected tab
            if (tab === 'overview') {
                overviewBtn.className = 'tab-button tab-active px-5 py-3 rounded-xl font-semibold';
                overviewSection.classList.remove('hidden');
            } else if (tab === 'details') {
                detailsBtn.className = 'tab-button tab-active px-5 py-3 rounded-xl font-semibold';
                detailsSection.classList.remove('hidden');
            } else if (tab === 'nonCompliant') {
                nonCompliantBtn.className = 'tab-button tab-active px-5 py-3 rounded-xl font-semibold';
                nonCompliantSection.classList.remove('hidden');
            }
        }

        // Event listeners
        document.getElementById('overviewBtn').addEventListener('click', () => switchTab('overview'));
        document.getElementById('detailsBtn').addEventListener('click', () => switchTab('details'));
        document.getElementById('nonCompliantBtn').addEventListener('click', () => switchTab('nonCompliant'));
        
        document.getElementById('searchInput').addEventListener('input', (e) => {
            filterData(e.target.value);
        });
        
        document.getElementById('clearSearch').addEventListener('click', () => {
            document.getElementById('searchInput').value = '';
            filterData('');
        });

        document.getElementById('nonCompliantSearchInput').addEventListener('input', (e) => {
            filterNonCompliantData(e.target.value);
        });
        
        document.getElementById('clearNonCompliantSearch').addEventListener('click', () => {
            document.getElementById('nonCompliantSearchInput').value = '';
            filterNonCompliantData('');
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
